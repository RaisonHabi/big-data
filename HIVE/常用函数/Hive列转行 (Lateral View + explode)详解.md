##
explode作用：处理map结构的字段，将数组转换成多行  </p><p data-pid="KYyEjyIG"> 所以我们现在先对category使用category函数：</p><div class="highlight"><pre><code class="language-text">select explode(category) from movie_info;</code></pre></div><p data-pid="kfx2TdxA">结果：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-e3c4f796e27f030b6c78152303172496_b.jpg" data-caption="" data-size="normal" data-rawwidth="789" data-rawheight="327" class="origin_image zh-lightbox-thumb" width="789" data-original="https://pic3.zhimg.com/v2-e3c4f796e27f030b6c78152303172496_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;789&#39; height=&#39;327&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="789" data-rawheight="327" class="origin_image zh-lightbox-thumb lazy" width="789" data-original="https://pic3.zhimg.com/v2-e3c4f796e27f030b6c78152303172496_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-e3c4f796e27f030b6c78152303172496_b.jpg"/></figure><p data-pid="oE-ujcjl">如果想要得到题目的需求结果，那么需要在此结果上，每一部电影和该电影对应的category进行笛卡尔积，得到结果：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-53eae67d1a31c362a48b2329c931ac3d_b.jpg" data-caption="" data-size="normal" data-rawwidth="820" data-rawheight="352" class="origin_image zh-lightbox-thumb" width="820" data-original="https://pic2.zhimg.com/v2-53eae67d1a31c362a48b2329c931ac3d_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;820&#39; height=&#39;352&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="820" data-rawheight="352" class="origin_image zh-lightbox-thumb lazy" width="820" data-original="https://pic2.zhimg.com/v2-53eae67d1a31c362a48b2329c931ac3d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-53eae67d1a31c362a48b2329c931ac3d_b.jpg"/></figure><p data-pid="ICQPovNK">如果我们直接</p><div class="highlight"><pre><code class="language-text">select  movie，explode(category) from movie_info;</code></pre></div><p data-pid="diq0_O32">查询直接报错，因为movie的结果只有三条，而explode(category)有 4 + 5 + 3 = 12条记录。</p><p data-pid="NabcvzeF">那么，我们由此引入LATERAL VIEW函数：</p><p class="ztext-empty-paragraph"><br/></p><p data-pid="fZNJAg9X">LATERAL VIEW：</p><blockquote data-pid="77fkXp3b">1.Lateral View 用于<b>和UDTF函数【explode,split】结合来使用</b>。<br/>2.首先通过UDTF函数将数据拆分成多行，再将多行结果组合成一个支持别名的虚拟表。<br/>3..主要解决在select使用UDTF做查询的过程中查询只能包含单个UDTF，不能包含其它字段以及多个UDTF的情况。<br/>4.语法：LATERAL VIEW udtf(expression)  tableAlias AS columnAlias (&#39;,&#39; columnAlias)</blockquote><p data-pid="LiQJ6Zrh">使用LATERAL VIEW  +  explode  函数进行查询，语句如下：</p><div class="highlight"><pre><code class="language-text">select movie,category_name 
from movie_info
LATERAL VIEW explode(category) tmpTable as category_name;
-- category_name 是给 explode(category) 列起的别名</code></pre></div><p data-pid="KixO_NG4">结果如下：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-07671335d5b31be1690230c58bcfc6e4_b.jpg" data-caption="" data-size="normal" data-rawwidth="967" data-rawheight="362" class="origin_image zh-lightbox-thumb" width="967" data-original="https://pic1.zhimg.com/v2-07671335d5b31be1690230c58bcfc6e4_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;967&#39; height=&#39;362&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="967" data-rawheight="362" class="origin_image zh-lightbox-thumb lazy" width="967" data-original="https://pic1.zhimg.com/v2-07671335d5b31be1690230c58bcfc6e4_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-07671335d5b31be1690230c58bcfc6e4_b.jpg"/></figure><p data-pid="UDzhRnuW">
  &nbsp;
## references
[Hive列转行 (Lateral View + explode)详解](https://zhuanlan.zhihu.com/p/115913870)
